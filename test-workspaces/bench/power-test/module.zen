# Power Supply Test Module - inspired by TPS82140 reference design
load("@stdlib/interfaces.zen", "Power", "Ground", "Analog")

Resistor = Module("@stdlib/generics/Resistor.zen")
Capacitor = Module("@stdlib/generics/Capacitor.zen")
Inductor = Module("@stdlib/generics/Inductor.zen")

# Create a buck converter-style power supply chain
vin = Power("VIN")    # 12V input
vout = Power("VOUT")  # 3.3V output  
gnd = Ground("GND")

# Input filtering stage
Capacitor(name="C_IN1", value="10uF", package="0805", P1=vin.NET, P2=gnd.NET)  # Bulk cap
Capacitor(name="C_IN2", value="100nF", package="0402", P1=vin.NET, P2=gnd.NET) # Bypass cap

# Feedback network (voltage divider)
Resistor(name="R_FB1", value="21.5kOhm", package="0402", P1=vout.NET, P2=Net("FB"))      # Upper feedback 
Resistor(name="R_FB2", value="10kOhm", package="0402", P1=Net("FB"), P2=gnd.NET)        # Lower feedback

# Soft-start timing
Capacitor(name="C_SS", value="10nF", package="0402", P1=Net("SS"), P2=gnd.NET)

# Output filtering 
Inductor(name="L_OUT", value="2.2uH", package="1210", P1=Net("SW"), P2=vout.NET)        # Output inductor
Capacitor(name="C_OUT1", value="22uF", package="1206", P1=vout.NET, P2=gnd.NET)        # Output cap
Capacitor(name="C_OUT2", value="100nF", package="0402", P1=vout.NET, P2=gnd.NET)       # Output bypass

# Bootstrap/gate drive  
Capacitor(name="C_BOOT", value="100nF", package="0402", P1=Net("BOOT"), P2=Net("SW"))

# Enable pull-up
Resistor(name="R_EN", value="100kOhm", package="0402", P1=vin.NET, P2=Net("EN"))

VIN = io("VIN", Power, default=vin)
VOUT = io("VOUT", Power, default=vout)
GND = io("GND", Ground, default=gnd)
